# Analizador RIPS - Resoluci√≥n 2275 de 2023 üè•

Sistema completo de an√°lisis y **validaci√≥n de calidad de datos RIPS** (Registros Individuales de Prestaci√≥n de Servicios de Salud) seg√∫n la Resoluci√≥n 2275 de 2023 del Ministerio de Salud de Colombia.

## üéØ Caracter√≠sticas Principales

El sistema analiza archivos RIPS JSON, **valida su calidad** y genera reportes ejecutivos detallados incluyendo:

### 1. **An√°lisis Demogr√°fico**
- Distribuci√≥n por sexo, edad, tipo de documento
- An√°lisis por zona territorial (urbana/rural)
- Distribuci√≥n geogr√°fica por municipio
- Cruces de sexo √ó edad

### 2. **An√°lisis de Diagn√≥sticos (CIE-10)**
- Top 10 diagn√≥sticos m√°s frecuentes **con nombre y descripci√≥n CIE-10**
- Identificaci√≥n de comorbilidades
- Diagn√≥sticos por grupo etario
- Diagn√≥sticos por sexo
- An√°lisis de diagn√≥sticos relacionados

### 3. **An√°lisis de Servicios**
- Total de consultas y distribuci√≥n temporal
- Usuarios con m√∫ltiples consultas
- Modalidad y finalidad de atenci√≥n
- Causas de atenci√≥n
- Servicios sin autorizaci√≥n
- An√°lisis financiero (valores y copagos)

### 4. **An√°lisis de Acudientes**
- Relaci√≥n paciente-acudiente
- Menores atendidos con acudiente
- Identificaci√≥n de acompa√±antes

### 5. **‚ú® NUEVO: Validaci√≥n de Calidad de Datos**
Sistema exhaustivo de validaci√≥n que detecta:

#### üîç **Validaciones Implementadas**
- ‚úÖ **Campos Obligatorios**: Verifica presencia de todos los campos requeridos
- ‚úÖ **Formatos**: Documentos, fechas, diagn√≥sticos CIE-10, valores num√©ricos
- ‚úÖ **Coherencia L√≥gica**:
  - Edad vs Tipo de Documento (RC/TI/CC)
  - Diagn√≥stico vs Sexo (embarazo en hombres)
  - Fechas futuras o muy antiguas
- ‚úÖ **C√≥digos V√°lidos**: Finalidad, causa externa, zona territorial
- ‚úÖ **Relaciones**: Menores sin acudiente, mayores con acudiente

#### üìä **Niveles de Calidad**
- üü¢ **EXCELENTE**: 0 anomal√≠as
- üü¢ **BUENA**: 1-5 anomal√≠as
- üü° **REGULAR**: 6-15 anomal√≠as
- üü† **DEFICIENTE**: 16-30 anomal√≠as
- üî¥ **CR√çTICA**: >30 anomal√≠as

#### üé® **Severidades de Anomal√≠as**
- üî¥ **ALTA**: Errores cr√≠ticos (campos obligatorios, formatos inv√°lidos)
- üü° **MEDIA**: Inconsistencias (tipo doc vs edad, fechas antiguas)
- üü¢ **BAJA**: Advertencias (mayor con acudiente)

### 6. **üìÅ Organizaci√≥n por Carpetas**
Cada archivo JSON procesado genera su propia carpeta con timestamp:
```
output/
‚îú‚îÄ‚îÄ 7687_156_2275_20251007_191305/
‚îÇ   ‚îú‚îÄ‚îÄ informe_completo.xlsx
‚îÇ   ‚îî‚îÄ‚îÄ informe_gerencial.docx
‚îî‚îÄ‚îÄ otro_archivo_20251007_192000/
    ‚îú‚îÄ‚îÄ informe_completo.xlsx
    ‚îî‚îÄ‚îÄ informe_gerencial.docx
```

## üóÇÔ∏è Estructura del Proyecto

```
InformadorJSON/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ cie10_codigos.json          # 12,634 c√≥digos CIE-10 con nombres y descripciones
‚îú‚îÄ‚îÄ input/
‚îÇ   ‚îî‚îÄ‚îÄ 7687_156_2275.json          # Archivo RIPS de ejemplo
‚îú‚îÄ‚îÄ output/                          # Reportes generados (carpetas por archivo)
‚îÇ   ‚îî‚îÄ‚îÄ 7687_156_2275_20251007_191305/
‚îÇ       ‚îú‚îÄ‚îÄ informe_completo.xlsx
‚îÇ       ‚îî‚îÄ‚îÄ informe_gerencial.docx
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ cargador_rips.py            # Carga de datos y c√≥digos CIE-10
‚îÇ   ‚îú‚îÄ‚îÄ analizador_rips.py          # An√°lisis de datos
‚îÇ   ‚îú‚îÄ‚îÄ validador_calidad.py        # üÜï Validaci√≥n de calidad de datos
‚îÇ   ‚îî‚îÄ‚îÄ generador_reportes.py       # Generaci√≥n de reportes Excel y DOCX
‚îú‚îÄ‚îÄ main.py                          # Script principal
‚îî‚îÄ‚îÄ README.md
```

## üöÄ Instalaci√≥n

### Requisitos
- Python 3.8 o superior
- pip (gestor de paquetes de Python)

### Instalar dependencias

```bash
pip install openpyxl python-docx matplotlib
```

## üìñ Uso

### 1. Preparar los datos

Coloca **uno o varios archivos JSON RIPS** en la carpeta `input/`:
```
input/
‚îú‚îÄ‚îÄ 7687_156_2275.json
‚îú‚îÄ‚îÄ 7687_156_2222.json
‚îî‚îÄ‚îÄ otro_archivo.json
```

### 2. Ejecutar el an√°lisis

El sistema procesar√° **autom√°ticamente TODOS los archivos JSON** en la carpeta `input/`:

```bash
python main.py
```

**Salida en consola:**
```
================================================================================
ANALIZADOR MASIVO DE RIPS - RESOLUCI√ìN 2275 DE 2023
================================================================================

Se encontraron 2 archivo(s) JSON para procesar:
  1. 7687_156_2222.json
  2. 7687_156_2275.json

Cargando c√≥digos CIE-10...
[OK] Cargados 12634 c√≥digos CIE-10

================================================================================
PROCESANDO ARCHIVO 1 DE 2
================================================================================
Archivo: input\7687_156_2222.json
...
[OK] Archivo procesado exitosamente

================================================================================
PROCESANDO ARCHIVO 2 DE 2
================================================================================
Archivo: input\7687_156_2275.json
...
[OK] Archivo procesado exitosamente

================================================================================
RESUMEN FINAL DEL PROCESO
================================================================================

Total de archivos procesados: 2
  [OK] Exitosos: 2

Los reportes se generaron en carpetas individuales dentro de 'output/'
```

### 3. Revisar los reportes

Los reportes se generan en **carpetas organizadas** dentro de `output/`:

Cada archivo JSON procesado crea una carpeta con formato `{nombre_archivo}_{timestamp}/`:

#### üìä **Informe Excel Completo** (`informe_completo.xlsx`)
Libro con **11 hojas especializadas**:
1. **Informaci√≥n General**: Datos b√°sicos del reporte
2. **Datos Personales**: Info completa de cada paciente
3. **Servicios por Paciente**: Detalle de servicios prestados
4. **An√°lisis Demogr√°fico**: Distribuciones por sexo, edad, documento
5. **Diagn√≥sticos**: Top diagn√≥sticos m√°s frecuentes
6. **Diagn√≥sticos por G√©nero**: An√°lisis segregado por sexo
7. **Distribuci√≥n por Edad**: An√°lisis etario con porcentajes
8. **Distribuci√≥n Territorial**: Por zona y municipio
9. **An√°lisis de Servicios**: Finalidades y causas de atenci√≥n
10. **Acudientes**: Relaci√≥n menores-acudientes
11. **üÜï Validaci√≥n de Calidad**:
    - Nivel de calidad con c√≥digo de color
    - Distribuci√≥n por severidad (ALTA, MEDIA, BAJA)
    - Top 10 tipos de anomal√≠as
    - Detalle completo de todas las anomal√≠as

#### üìÑ **Informe Gerencial DOCX** (`informe_gerencial.docx`)
Documento Word profesional con:
1. **Resumen Ejecutivo**: An√°lisis narrativo
2. **An√°lisis Demogr√°fico**: Con gr√°ficos de torta y barras
3. **Distribuci√≥n Territorial**: Gr√°ficos urbana/rural
4. **An√°lisis de Diagn√≥sticos**: Gr√°ficos y tablas top 10
5. **An√°lisis por G√©nero**: Comparaci√≥n F vs M
6. **Motivos de Consulta**: Gr√°ficos de causas
7. **An√°lisis de Servicios**: Distribuci√≥n por finalidad
8. **üÜï Validaci√≥n de Calidad**:
   - Nivel de calidad con c√≥digo de color
   - Distribuci√≥n por severidad
   - Top 10 anomal√≠as m√°s frecuentes
   - Detalle de anomal√≠as cr√≠ticas
9. **Conclusiones y Recomendaciones**: Hallazgos y sugerencias

## üìä Ejemplo de Salida

### Resumen en Consola

```
================================================================================
ANALIZADOR DE RIPS - RESOLUCI√ìN 2275 DE 2023
================================================================================

Procesando archivo: input/7687_156_2275.json

Cargando c√≥digos CIE-10...
[OK] Cargados 12634 c√≥digos CIE-10

Cargando datos RIPS...
[OK] Datos RIPS cargados exitosamente

Ejecutando an√°lisis...
[OK] An√°lisis completado

Validando calidad de datos...
[OK] Validaci√≥n completada - Nivel de calidad: EXCELENTE
    Total de anomal√≠as detectadas: 0

Generando reportes...
[OK] Reporte Excel: output\7687_156_2275_20251007_191305\informe_completo.xlsx
[OK] Informe Gerencial DOCX: output\7687_156_2275_20251007_191305\informe_gerencial.docx

================================================================================
RESUMEN EJECUTIVO
================================================================================

Total de usuarios: 22
Total de consultas: 42
Diagn√≥sticos √∫nicos: 10

--- TOP 5 DIAGN√ìSTICOS M√ÅS FRECUENTES ---
1. [Z719] CONSULTA, NO ESPECIFICADA
   PERSONA EN CONTACTO CON LOS SERVICIOS DE SALUD POR OTRAS CONSULTAS...
   Cantidad: 14

2. [Z717] CONSULTA PARA ASESORIA SOBRE EL VIRUS DE LA INMUNODEFICIENCIA...
   PERSONA EN CONTACTO CON LOS SERVICIOS DE SALUD POR OTRAS CONSULTAS...
   Cantidad: 8

3. [Z012] EXAMEN ODONTOLOGICO
   OTROS EXAMENES ESPECIALES E INVESTIGACION DE PERSONAS SIN QUEJAS...
   Cantidad: 7

4. [Z359] SUPERVISION DE EMBARAZO DE ALTO RIESGO, SIN OTRA ESPECIFICACION
   SUPERVISION DE EMBARAZO DE ALTO RIESGO
   Cantidad: 4

5. [Z391] ATENCION Y EXAMEN DE MADRE EN PERIODO DE LACTANCIA
   EXAMEN Y ATENCION DEL POSTPARTO
   Cantidad: 3

================================================================================
Proceso completado exitosamente
================================================================================
```

### Reporte de Texto (fragmento)

```
================================================================================
REPORTE DE AN√ÅLISIS RIPS - RESOLUCI√ìN 2275 DE 2023
================================================================================

AN√ÅLISIS DE DIAGN√ìSTICOS
================================================================================
Total de Diagn√≥sticos Registrados: 56
Diagn√≥sticos √önicos: 11
Casos con Comorbilidades: 3

TOP 10 DIAGN√ìSTICOS M√ÅS FRECUENTES:
--------------------------------------------------------------------------------
1. [Z719] CONSULTA NO ESPECIFICADA
   Descripci√≥n: PERSONAS EN CONTACTO CON LOS SERVICIOS DE SALUD POR OTRAS RAZONES
   Cantidad: 20

2. [Z717] ORIENTACION Y CONSEJO SOBRE ANTICONCEPCION
   Descripci√≥n: PERSONAS EN CONTACTO CON LOS SERVICIOS DE SALUD POR OTRAS RAZONES
   Cantidad: 10

COMORBILIDADES IDENTIFICADAS:
--------------------------------------------------------------------------------
1. Diagn√≥stico Principal: [Z000] EXAMEN GENERAL Y EVALUACION DE SALUD DE NI√ëOS NO ENFERMOS
   Diagn√≥sticos Relacionados:
   - [N771] VAGINITIS VULVITIS Y VULVOVAGINITIS EN ENFERMEDADES CLASIFICADAS EN OTRA PARTE
   - [Z308] OTRAS INVESTIGACIONES ESPECIALES DE PESQUISA
```

## üîç Informaci√≥n Clave que se Extrae

### Cruces de Informaci√≥n Importantes

1. **Edad √ó Sexo √ó Diagn√≥stico**: Morbilidad por grupo poblacional
2. **Municipio √ó Diagn√≥stico**: Caracterizaci√≥n epidemiol√≥gica territorial
3. **Finalidad √ó Causa**: Diferenciaci√≥n preventiva vs curativa
4. **Usuario √ó M√∫ltiples consultas**: Fragmentaci√≥n de atenci√≥n
5. **Diagn√≥stico principal √ó Relacionados**: Comorbilidades
6. **Paciente √ó Acudiente**: Atenci√≥n a menores

### C√≥digos Especiales Identificados

- **C√≥digos Z**: Atenci√≥n preventiva y administrativa
  - Z719: Consulta no especificada
  - Z717: Anticoncepci√≥n
  - Z012: Examen de rutina infantil
  - Z359: Asesor√≠a anticonceptiva

## üìÅ Configuraci√≥n CIE-10

El archivo `config/cie10_codigos.json` contiene **12,634 c√≥digos CIE-10** con:
- **C√≥digo**: Identificador CIE-10 (ej: "Z719")
- **Nombre**: Descripci√≥n detallada del diagn√≥stico
- **Descripci√≥n**: Categor√≠a general del diagn√≥stico

Este archivo se genera autom√°ticamente desde el Excel `TablaReferencia_CIE10__1.xlsx`.

### Regenerar el archivo CIE-10

Si necesitas actualizar los c√≥digos:

```bash
python -c "import openpyxl, json; wb = openpyxl.load_workbook(r'TablaReferencia_CIE10__1.xlsx'); ws = wb.active; cie10 = {str(ws.cell(i, 1).value): {'nombre': str(ws.cell(i, 2).value) if ws.cell(i, 2).value else '', 'descripcion': str(ws.cell(i, 3).value) if ws.cell(i, 3).value else ''} for i in range(2, ws.max_row + 1) if ws.cell(i, 1).value}; open('config/cie10_codigos.json', 'w', encoding='utf-8').write(json.dumps(cie10, indent=2, ensure_ascii=False))"
```

## üõ†Ô∏è Personalizaci√≥n

### Analizar otro archivo RIPS

Edita [main.py](main.py:19) l√≠nea 19:

```python
archivo_rips = "input/tu_archivo.json"
```

### Modificar an√°lisis

Los m√≥dulos est√°n separados por funcionalidad:
- **[cargador_rips.py](src/cargador_rips.py)**: A√±adir m√©todos de carga
- **[analizador_rips.py](src/analizador_rips.py)**: A√±adir nuevos an√°lisis
- **[generador_reportes.py](src/generador_reportes.py)**: Modificar formatos de salida

## üìå Notas Importantes

1. Los c√≥digos CIE-10 se almacenan **separadamente** en `config/cie10_codigos.json`
2. El sistema es **defensivo**: valida datos faltantes y maneja errores
3. Los reportes incluyen **timestamps** para evitar sobrescritura
4. Compatible con la estructura JSON de la **Resoluci√≥n 2275 de 2023**

## üîç Tipos de Anomal√≠as Detectadas

### üî¥ Severidad ALTA (Cr√≠ticas)
- Campos obligatorios faltantes
- Formato de documento inv√°lido
- Formato de fecha inv√°lido
- Fechas futuras
- Edad negativa o excesiva (>120 a√±os)
- Formato de edad inv√°lido
- Valor de sexo inv√°lido (debe ser F o M)
- Formato de diagn√≥stico inv√°lido (debe seguir CIE-10)
- Incoherencia diagn√≥stico-sexo (ej: embarazo en hombres)
- C√≥digos de finalidad/causa inv√°lidos

### üü° Severidad MEDIA
- Longitud de documento inv√°lida seg√∫n tipo
- Fechas muy antiguas (>10 a√±os)
- Incoherencia tipo documento-edad (RC/TI/CC)
- Tipo de diagn√≥stico inv√°lido
- Menor sin acudiente registrado
- Valores negativos (consulta, copago)
- Formato de valores num√©ricos inv√°lido
- C√≥digo de zona territorial inv√°lido

### üü¢ Severidad BAJA
- Mayor de edad con acudiente (verificar si aplica)

## üìö Referencias

- **Resoluci√≥n 2275 de 2023**: Est√°ndares de reportes RIPS en Colombia
- **CIE-10**: Clasificaci√≥n Internacional de Enfermedades, 10¬™ revisi√≥n

## üìÑ Licencia

Proyecto de an√°lisis para entidades de salud bajo normativa colombiana.

## üë®‚Äçüíª Autor

Desarrollado para an√°lisis y validaci√≥n de calidad de RIPS en el sector salud colombiano.

---

**Versi√≥n**: 2.0 con Validaci√≥n de Calidad
**√öltima actualizaci√≥n**: Octubre 2025
**Desarrollado con**: Python 3.10, OpenPyXL, python-docx, Matplotlib
